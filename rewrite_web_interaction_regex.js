const fs = require('fs');
const path = require('path');
const cheerio = require('cheerio');

const filePath = path.join(__dirname, 'web-interaction.html');
let content = fs.readFileSync(filePath, 'utf8');

// 1. Replace timeline-group__summary
const timelineSummaries = [
  `웹 브라우저에 자바스크립트라는 마법의 지팡이가 생겼어요! 덕분에 화면이 깜빡이지 않고도 새로운 소식을 짠! 하고 보여줄 수 있게 되었답니다.`,
  `에이잭스(Ajax)라는 멋진 마법이 유행하면서, "웹 브라우저와 서버 친구가 같은 언어로 대화하면 어떨까?"라는 재미있는 상상을 하게 되었어요.`,
  `리액트(React) 요정이 나타나 화면을 레고 블록처럼 조립하게 도와주었어요. 인터넷이 끊겨도 끄떡없는 튼튼한 웹 세상이 열렸답니다!`,
  `이제는 무거운 프로그램을 설치하지 않아도 웹 브라우저 안에서 쌩쌩 돌아가는 멋진 3D 게임과 똑똑한 인공지능 친구를 만날 수 있게 되었어요!`
];

let summaryIndex = 0;
content = content.replace(/<p class="timeline-group__summary">([\s\S]*?)<\/p>/g, (match, p1) => {
  if (summaryIndex < timelineSummaries.length) {
    const newText = timelineSummaries[summaryIndex++];
    return `<p class="timeline-group__summary">${newText}</p>`;
  }
  return match;
});

// 2. Replace event-detail__summary, event-detail__story, event-detail__notes
const eventSummaries = {
  '1995': `"우와, 내가 누른 버튼이 바로 움직여요!" 웹 브라우저에 마법의 주문이 생기면서 화면이 살아 숨 쉬기 시작했답니다.`,
  '1996': `"우와, 버튼이 덩실덩실 춤을 춰요!" 플래시(Flash) 요정이 나타나 웹사이트에 신나는 음악과 화려한 움직임을 선물했답니다.`,
  '1999': `"화면이 깜빡이지 않고도 새 편지가 도착했어요!" 조용히 편지를 배달해 주는 비밀 우체부 아저씨가 등장했답니다.`,
  '2005': `"웹사이트가 마치 내 컴퓨터에 깔린 프로그램 같아요!" 에이잭스(Ajax)라는 멋진 이름이 생기면서 웹의 새로운 시대가 열렸어요.`,
  '2006': `"복잡한 주문은 이제 그만! 짧은 주문 한 줄이면 충분해요." 제이쿼리(jQuery) 요정이 나타나 마법을 아주 쉽게 만들어 주었어요.`,
  '2009': `"웹 브라우저에서 쓰던 마법을 서버에서도 쓸 수 있다고요?" 노드제이에스(Node.js)가 등장하며 자바스크립트의 무대가 넓어졌어요.`,
  '2011': `"이제 편지를 기다리지 않고 바로바로 이야기할 수 있어요!" 웹소켓(WebSocket)이라는 마법의 전화기가 생겼답니다.`,
  '2013': `"화면을 레고 블록처럼 조립해 볼까요?" 리액트(React) 요정이 나타나 웹을 만드는 새로운 방법을 알려주었어요.`,
  '2014': `"인터넷이 끊겨도 웹사이트가 열려요!" 서비스 워커(Service Worker)라는 든든한 수호천사가 나타났답니다.`,
  '2015': `"앗, 플래시 성에 나쁜 악당이 들어왔어요!" 전 세계 브라우저 마을에 비상이 걸렸던 아찔한 사건이 있었답니다.`,
  '2017': `"어머나, 비밀 편지가 밖으로 새어 나갔어요!" 클라우드플레어(Cloudflare) 마을에서 일어난 깜짝 놀랄 소동이었어요.`,
  '2020': `"무거운 프로그램도 웹에서 깃털처럼 가볍게 돌아가요!" 웹어셈블리(WebAssembly)라는 엄청난 힘을 가진 영웅이 등장했어요.`,
  '2021': `"버벅거림 없이 매끄러운 영상을 즐겨요!" 웹코덱(WebCodecs) 요정이 나타나 영상 마술을 부리기 시작했어요.`,
  '2023': `"웹 브라우저가 슈퍼컴퓨터로 변신했어요!" 웹지피유(WebGPU)라는 강력한 마법 지팡이가 등장했답니다.`
};

const eventStories = {
  '1995': `<p>옛날 옛적 넷스케이프라는 마을에 브렌던이라는 뚝딱뚝딱 발명가가 살았어요. 그는 단 10일 만에 화면을 움직이게 하는 마법의 주문을 만들어냈죠! 버튼을 콕 누르자 뿅! 하고 알림창이 뜨는 걸 보고 친구들은 깜짝 놀랐어요.</p>\n\t\t\t\t<p>"우와! 멀리 있는 서버 할아버지한테 물어보지 않아도, 브라우저가 바로바로 대답을 해주네!" 사람들은 이 신기한 마법으로 무엇을 더 할 수 있을지 신나게 상상하기 시작했답니다.</p>`,
  '1996': `<p>1996년, 매크로미디어라는 곳에서 '플래시(Flash)'라는 멋진 그림 도구를 세상에 내놓았어요. 한 디자이너가 마우스를 올리면 반짝반짝 빛나는 메뉴를 만들며 "이제 멈춰있는 그림 대신 살아 움직이는 그림을 그릴 수 있어요!"라며 기뻐했죠.</p>\n\t\t\t\t<p>곧이어 수많은 웹사이트들이 플래시로 예쁜 애니메이션과 신나는 뮤직비디오를 만들기 시작했어요. 사람들은 웹 브라우저 안에서 마치 만화 영화를 보는 것처럼 즐거운 시간을 보냈답니다.</p>`,
  '1999': `<p>어느 날, 이메일을 만드는 팀에서 "새 편지가 올 때마다 화면 전체를 다시 그리는 건 너무 힘들어!"라는 고민을 했죠. 그래서 화면 뒤에서 몰래 편지만 쏙 가져오는 '비밀 우체부'를 만들었어요.</p>\n\t\t\t\t<p>사람들은 "우와! 새로고침 버튼을 누르지 않았는데 새 편지가 뿅 하고 나타났어!"라며 신기해했어요. 다른 브라우저 친구들도 이 멋진 비밀 우체부를 따라 만들기 시작했답니다.</p>`,
  '2005': `<p>어느 날, 사람들이 모여 구글 지도를 보며 깜짝 놀랐어요. 마우스로 지도를 쓱쓱 끌어당기는데 화면이 끊기지 않고 부드럽게 움직였거든요! "우와, 웹사이트가 진짜 프로그램처럼 부드럽게 움직이네!"</p>\n\t\t\t\t<p>이 멋진 마법에 '에이잭스(Ajax)'라는 멋진 이름이 붙여졌어요. 수많은 발명가들이 이 마법을 배우기 위해 모여들었고, 더 재미있고 편리한 웹사이트들을 만들기 시작했답니다.</p>`,
  '2006': `<p>존이라는 똑똑한 마법사가 나타나 사람들에게 짧은 주문 하나를 보여주었어요. "수리수리 마수리, 얍!" 그러자 복잡했던 화면이 한 번에 짠! 하고 바뀌었죠. 사람들은 "우와! 브라우저마다 달랐던 복잡한 주문이 이렇게 쉬워지다니!"라며 기뻐했어요.</p>\n\t\t\t\t<p>이 마법의 이름은 '제이쿼리'였어요. 제이쿼리 덕분에 누구나 쉽게 예쁜 슬라이드와 팝업창을 만들 수 있게 되었고, 웹 세상은 더욱 풍성하고 아름다워졌답니다.</p>`,
  '2009': `<p>라이언이라는 발명가가 무대에 올라와 신기한 마술 상자를 보여주었어요. "이 상자를 쓰면 수만 명의 친구들이 동시에 채팅을 해도 끄떡없어요!" 사람들은 깜짝 놀라며 너도나도 마술 상자를 열어보았죠.</p>\n\t\t\t\t<p>이 마술 상자의 이름은 '노드제이에스'였어요. 이제 사람들은 웹 브라우저뿐만 아니라 보이지 않는 서버 마을에서도 자바스크립트 마법을 마음껏 부릴 수 있게 되었답니다.</p>`,
  '2011': `<p>옛날에는 서버 할아버지에게 "새 소식 있어요?"라고 계속 물어봐야 했어요. 하지만 어느 날, '웹소켓'이라는 마법의 전화기가 발명되었죠! "안녕!" 하고 인사하면 서버 할아버지가 즉시 "안녕!" 하고 대답해 주었어요.</p>\n\t\t\t\t<p>사람들은 "우와! 이제 계속 물어보지 않아도 바로바로 이야기를 나눌 수 있네!"라며 기뻐했어요. 덕분에 우리는 친구들과 실시간으로 신나게 채팅도 하고 게임도 즐길 수 있게 되었답니다.</p>`,
  '2013': `<p>조던이라는 마법사가 무대에 올라와 신기한 레고 블록을 보여주었어요. "화면을 통째로 그리지 말고, 작은 블록들로 나누어 조립해 보세요!" 버튼을 누르자 필요한 블록만 쏙쏙 바뀌는 걸 보고 사람들은 "우와!" 하고 탄성을 질렀죠.</p>\n\t\t\t\t<p>이 마법의 이름은 '리액트'였어요. 사람들은 리액트 블록을 이리저리 조립하며 훨씬 더 크고 멋진 웹사이트 성을 뚝딱뚝딱 짓기 시작했답니다.</p>`,
  '2014': `<p>어느 날, 브라우저를 닫았는데도 "띠링!" 하고 새로운 소식이 도착했어요! 사람들은 깜짝 놀라며 박수를 쳤죠. 인터넷이 연결되지 않은 깊은 산속이나 지하철에서도 웹사이트를 볼 수 있게 된 거예요.</p>\n\t\t\t\t<p>이 모든 건 '서비스 워커'라는 수호천사 덕분이었어요. 수호천사가 미리 재미있는 이야기들을 가방에 담아두었다가, 인터넷이 끊기면 짠! 하고 꺼내서 보여주었거든요.</p>`,
  '2015': `<p>어느 여름날, 화려하고 멋진 플래시 성에 나쁜 악당들이 몰래 들어올 수 있는 비밀 통로가 발견되었어요! 마을 사람들은 깜짝 놀라 "위험해! 당장 플래시 성의 문을 닫아야 해!"라고 외쳤죠.</p>\n\t\t\t\t<p>브라우저 마을의 촌장님들은 서둘러 회의를 열고, 사람들을 보호하기 위해 플래시 성으로 가는 길을 꽁꽁 막아버렸어요. 이 사건을 계기로 사람들은 더 안전하고 튼튼한 새로운 성을 짓기로 결심했답니다.</p>`,
  '2017': `<p>어느 깊은 밤, 한 똑똑한 탐정이 클라우드플레어 마을의 경비원에게 다급하게 전화를 걸었어요. "큰일 났어요! 사람들의 소중한 비밀 편지가 길거리에 흩날리고 있어요!" 경비원들은 깜짝 놀라 비상벨을 울렸죠.</p>\n\t\t\t\t<p>마을 사람들은 서둘러 흩어진 편지들을 줍고, 혹시 모를 위험에 대비해 모두의 자물쇠 비밀번호를 새로 바꾸도록 안내했어요. 정말 가슴이 철렁 내려앉는 밤이었답니다.</p>`,
  '2020': `<p>어느 날, 한 발명가가 무거운 3D 찰흙 놀이를 웹 브라우저 안에서 쓱쓱 해내는 모습을 보여주었어요. 사람들은 "우와! 컴퓨터에 무거운 프로그램을 깔지 않았는데도 이렇게 빠르다니!"라며 눈이 휘둥그레졌죠.</p>\n\t\t\t\t<p>이 엄청난 힘의 비밀은 바로 '웹어셈블리'였어요. 웹어셈블리 영웅 덕분에 낡은 컴퓨터에서도 복잡한 피아노 소리를 척척 알아듣는 신기한 마법이 가능해졌답니다.</p>`,
  '2021': `<p>한 마술사가 무대에 올라와 눈 깜짝할 새에 영상을 뚝딱뚝딱 편집하는 모습을 보여주었어요. "우와! 영상이 하나도 끊기지 않고 물 흐르듯 자연스러워요!" 사람들은 박수를 치며 환호했죠.</p>\n\t\t\t\t<p>이 마술의 비밀은 '웹코덱' 요정이었어요. 요정의 도움으로 친구들과 얼굴에 재미있는 스티커를 붙이며 영상 통화를 하고, 멀리 떨어져 있어도 함께 신나게 게임을 즐길 수 있게 되었답니다.</p>`,
  '2023': `<p>어느 날, 게임을 만드는 요정들이 모여 신기한 마법 지팡이를 휘둘렀어요. 그러자 웹 브라우저 안에서 엄청나게 화려하고 빠른 3D 게임이 쌩쌩 돌아가기 시작했죠! "우와, 복잡한 설치 없이도 이렇게 멋진 게임을 할 수 있다니!"</p>\n\t\t\t\t<p>이 마법 지팡이의 이름은 '웹지피유'였어요. 이 지팡이 덕분에 똑똑한 인공지능 친구도 웹 브라우저 안으로 쏙 들어와서, 우리가 묻는 말에 척척 대답해 줄 수 있게 되었답니다.</p>`
};

const eventNotes = {
  '1995': `<p>이 마법의 이름이 바로 '자바스크립트(JavaScript)'랍니다. 자바스크립트 덕분에 딱딱한 글자만 있던 웹 페이지가 우리가 누르고 만질 수 있는 재미있는 놀이터로 변신하게 되었어요.</p>`,
  '1996': `<p>플래시는 웹을 아주 화려하게 꾸며주는 마법사였어요. 비록 지금은 다른 마법들에게 자리를 물려주었지만, "웹에서도 이렇게 멋진 움직임을 만들 수 있구나!"라는 꿈을 심어준 아주 고마운 친구랍니다.</p>`,
  '1999': `<p>이 비밀 우체부의 진짜 이름은 'XMLHttpRequest'예요. 이 우체부 덕분에 우리가 웹사이트를 보면서도 뒤에서는 새로운 정보를 계속 받아올 수 있는 아주 똑똑한 웹 세상이 열리게 되었어요.</p>`,
  '2005': `<p>에이잭스는 화면 뒤에서 몰래 데이터를 가져와서 필요한 부분만 쏙쏙 바꿔주는 기술이에요. 이 기술 덕분에 우리는 기다림 없이 빠르고 부드러운 웹사이트를 즐길 수 있게 되었답니다.</p>`,
  '2006': `<p>제이쿼리는 복잡하고 어려운 자바스크립트 마법을 아주 쉽고 간단하게 쓸 수 있게 도와주는 친절한 도우미였어요. 덕분에 웹을 만드는 사람들이 훨씬 더 빠르고 즐겁게 일할 수 있었답니다.</p>`,
  '2009': `<p>노드제이에스 덕분에 앞모습을 꾸미는 요정들과 뒷모습을 챙기는 요정들이 같은 언어로 대화할 수 있게 되었어요. 그래서 훨씬 더 빠르고 멋진 웹사이트를 만들 수 있게 되었답니다.</p>`,
  '2011': `<p>웹소켓은 브라우저와 서버를 튼튼한 파이프로 연결해 주는 기술이에요. 이 파이프를 통해 언제든지 빠르고 끊김 없이 서로 대화를 나눌 수 있게 되었답니다.</p>`,
  '2013': `<p>리액트는 화면의 모습을 기억해 두었다가, 바뀐 부분만 아주 빠르게 고쳐주는 똑똑한 요정이에요. 덕분에 복잡한 화면도 엉키지 않고 예쁘게 관리할 수 있게 되었답니다.</p>`,
  '2014': `<p>서비스 워커는 브라우저 뒤에서 조용히 일하며 데이터를 저장해 주는 고마운 친구예요. 덕분에 웹사이트도 진짜 스마트폰 앱처럼 언제 어디서나 든든하게 사용할 수 있게 되었답니다.</p>`,
  '2015': `<p>이 무서운 사건 이후로, 웹 마을 사람들은 플래시 대신 더 안전하고 표준화된 HTML5라는 새로운 마법을 사용하기 시작했어요. 아쉽지만 플래시 요정과는 서서히 작별 인사를 나누게 되었답니다.</p>`,
  '2017': `<p>이 사건은 아무리 튼튼한 성벽이라도 작은 틈새로 비밀이 샐 수 있다는 걸 알려주었어요. 이후로 웹 마을 사람들은 성벽을 더욱 꼼꼼하게 살피고, 비밀을 지키는 방법을 더욱 단단하게 만들었답니다.</p>`,
  '2020': `<p>웹어셈블리는 브라우저가 아주 어려운 수학 문제도 순식간에 풀 수 있게 도와주는 똑똑한 번역기예요. 덕분에 웹은 단순한 문서를 넘어, 무엇이든 할 수 있는 만능 놀이터가 되었답니다.</p>`,
  '2021': `<p>웹코덱은 무거운 영상 데이터를 아주 작고 가볍게 포장해서 빠르게 배달해 주는 기술이에요. 덕분에 우리는 웹에서도 텔레비전처럼 선명하고 끊김 없는 영상을 볼 수 있게 되었어요.</p>`,
  '2023': `<p>웹지피유는 컴퓨터의 숨겨진 힘을 웹 브라우저가 마음껏 쓸 수 있게 해주는 열쇠예요. 이 열쇠 덕분에 앞으로 웹 세상에서는 우리가 상상하는 모든 것이 현실이 될 수 있을 거예요!</p>`
};

content = content.replace(/<template id="event-(\d{4})-[^>]+>([\s\S]*?)<\/template>/g, (match, year, templateContent) => {
  let newTemplateContent = templateContent;
  
  if (eventSummaries[year]) {
    newTemplateContent = newTemplateContent.replace(/<p class="event-detail__summary">([\s\S]*?)<\/p>/, `<p class="event-detail__summary">${eventSummaries[year]}</p>`);
  }
  
  if (eventStories[year]) {
    const imgTag = `<img src="assets/images/story_web-interaction_${year}.png" alt="${year}년의 이야기 그림" class="story-image" style="width:100%; border-radius:8px; margin-bottom:1rem;">`;
    newTemplateContent = newTemplateContent.replace(/<div class="event-detail__story">([\s\S]*?)<\/div>/, `<div class="event-detail__story">\n\t\t\t\t${imgTag}\n\t\t\t\t${eventStories[year]}\n\t\t\t</div>`);
  }
  
  if (eventNotes[year]) {
    newTemplateContent = newTemplateContent.replace(/<div class="event-detail__notes">([\s\S]*?)<\/div>/, `<div class="event-detail__notes">\n\t\t\t\t${eventNotes[year]}\n\t\t\t</div>`);
  }
  
  return match.replace(templateContent, newTemplateContent);
});

fs.writeFileSync(filePath, content, 'utf8');
console.log('Successfully updated web-interaction.html');
