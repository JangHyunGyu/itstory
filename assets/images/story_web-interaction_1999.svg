<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450" width="800" height="450">
  <defs>
    <linearGradient id="bg99" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d1b2a"/>
      <stop offset="100%" style="stop-color:#1b3a5c"/>
    </linearGradient>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2a5298"/>
      <stop offset="100%" style="stop-color:#1e3c72"/>
    </linearGradient>
  </defs>
  <rect width="800" height="450" fill="url(#bg99)"/>

  <!-- IE/Outlook Web Access window -->
  <rect x="40" y="30" width="340" height="280" rx="6" fill="#c0c0c0" stroke="#808080" stroke-width="1.5"/>
  <!-- Title bar IE blue -->
  <rect x="40" y="30" width="340" height="28" rx="6" fill="#0055b3"/>
  <rect x="40" y="44" width="340" height="14" fill="#0055b3"/>
  <text x="160" y="48" font-family="sans-serif" font-size="11" fill="white" text-anchor="middle">Outlook Web Access - Inbox</text>
  <!-- Window controls -->
  <rect x="343" y="34" width="12" height="12" rx="1" fill="#ff4444"/>
  <rect x="329" y="34" width="12" height="12" rx="1" fill="#ffaa00"/>
  <rect x="315" y="34" width="12" height="12" rx="1" fill="#00cc44"/>

  <!-- Toolbar -->
  <rect x="40" y="58" width="340" height="22" fill="#e0e0e0" stroke="#aaa" stroke-width="0.5"/>
  <text x="55" y="73" font-family="sans-serif" font-size="10" fill="#333">New</text>
  <text x="85" y="73" font-family="sans-serif" font-size="10" fill="#333">Reply</text>
  <text x="122" y="73" font-family="sans-serif" font-size="10" fill="#333">Delete</text>

  <!-- Email list area -->
  <rect x="40" y="80" width="340" height="220" fill="white"/>
  <!-- Email list header -->
  <rect x="40" y="80" width="340" height="20" fill="#e8e8e8"/>
  <text x="56" y="94" font-family="sans-serif" font-size="10" fill="#555">From</text>
  <text x="160" y="94" font-family="sans-serif" font-size="10" fill="#555">Subject</text>
  <text x="320" y="94" font-family="sans-serif" font-size="10" fill="#555">Date</text>

  <!-- Email rows -->
  <rect x="40" y="100" width="340" height="24" fill="#ddeeff"/>
  <text x="56" y="116" font-family="sans-serif" font-size="10" fill="#000" font-weight="bold">boss@company.com</text>
  <text x="160" y="116" font-family="sans-serif" font-size="10" fill="#000" font-weight="bold">Q4 Report</text>
  <rect x="40" y="124" width="340" height="24" fill="white"/>
  <text x="56" y="140" font-family="sans-serif" font-size="10" fill="#333">team@company.com</text>
  <text x="160" y="140" font-family="sans-serif" font-size="10" fill="#333">Meeting Notes</text>
  <rect x="40" y="148" width="340" height="24" fill="#f5f5f5"/>
  <text x="56" y="164" font-family="sans-serif" font-size="10" fill="#333">hr@company.com</text>
  <text x="160" y="164" font-family="sans-serif" font-size="10" fill="#333">Holiday Schedule</text>

  <!-- NEW EMAIL notification arrow - appears without refresh -->
  <rect x="40" y="172" width="340" height="24" fill="#fff3cd" stroke="#ffc107" stroke-width="1"/>
  <text x="56" y="188" font-family="sans-serif" font-size="10" fill="#856404" font-weight="bold">★ new@sender.com</text>
  <text x="180" y="188" font-family="sans-serif" font-size="10" fill="#856404" font-weight="bold">New mail! (no refresh)</text>

  <!-- "No page reload!" speech bubble -->
  <rect x="40" y="206" width="340" height="50" rx="4" fill="#e8f5e9"/>
  <text x="60" y="225" font-family="sans-serif" font-size="11" fill="#2e7d32">✓  Mail updated without page reload!</text>
  <text x="60" y="244" font-family="sans-serif" font-size="10" fill="#555">XMLHttpRequest: MSXML2.XMLHTTP ActiveX</text>

  <!-- Status bar -->
  <rect x="40" y="300" width="340" height="18" fill="#e0e0e0" stroke="#aaa" stroke-width="0.5"/>
  <text x="50" y="312" font-family="sans-serif" font-size="9" fill="#555">Done</text>

  <!-- Center: Data flow diagram -->
  <!-- Browser box -->
  <rect x="180" y="140" width="100" height="50" rx="6" fill="#0055b3" stroke="#4488dd" stroke-width="1.5" opacity="0.0"/>

  <!-- Right side: XMLHttpRequest explanation -->
  <rect x="420" y="30" width="340" height="340" rx="6" fill="#0d2240" stroke="#4488dd" stroke-width="1"/>

  <!-- XHR flow diagram -->
  <!-- Browser -->
  <rect x="440" y="50" width="120" height="60" rx="6" fill="#1a3a5c" stroke="#4488dd" stroke-width="1.5"/>
  <text x="500" y="76" font-family="sans-serif" font-size="12" fill="#88bbff" text-anchor="middle">IE Browser</text>
  <text x="500" y="92" font-family="monospace" font-size="9" fill="#aaa" text-anchor="middle">ActiveX / MSXML</text>

  <!-- Arrow down -->
  <line x1="500" y1="110" x2="500" y2="150" stroke="#4488dd" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <defs>
    <marker id="arrowBlue" markerWidth="8" markerHeight="8" refX="4" refY="4" orient="auto">
      <polygon points="0,0 8,4 0,8" fill="#4488dd"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="8" refX="4" refY="4" orient="auto">
      <polygon points="0,0 8,4 0,8" fill="#44dd88"/>
    </marker>
  </defs>

  <!-- XHR Object box -->
  <rect x="430" y="150" width="140" height="50" rx="4" fill="#1e4a2e" stroke="#44dd88" stroke-width="1.5"/>
  <text x="500" y="172" font-family="monospace" font-size="11" fill="#44ff88" text-anchor="middle">XMLHttpRequest</text>
  <text x="500" y="188" font-family="monospace" font-size="9" fill="#aaa" text-anchor="middle">.send() async</text>

  <!-- Arrow right to server -->
  <line x1="570" y1="175" x2="630" y2="175" stroke="#44dd88" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="600" y="168" font-family="monospace" font-size="9" fill="#aaa" text-anchor="middle">HTTP GET</text>

  <!-- Server box -->
  <rect x="630" y="150" width="110" height="50" rx="4" fill="url(#serverGrad)" stroke="#4488dd" stroke-width="1.5"/>
  <text x="685" y="172" font-family="sans-serif" font-size="11" fill="#88bbff" text-anchor="middle">IIS Server</text>
  <text x="685" y="188" font-family="sans-serif" font-size="9" fill="#aaa" text-anchor="middle">Exchange / OWA</text>

  <!-- Response arrow back -->
  <line x1="630" y1="195" x2="570" y2="215" stroke="#ffaa44" stroke-width="2"/>
  <polygon points="570,211 570,219 578,215" fill="#ffaa44"/>
  <text x="600" y="210" font-family="monospace" font-size="9" fill="#ffaa44" text-anchor="middle">XML data</text>

  <!-- DOM update -->
  <rect x="430" y="240" width="140" height="40" rx="4" fill="#3a1a0a" stroke="#ff8844" stroke-width="1.5"/>
  <text x="500" y="258" font-family="monospace" font-size="11" fill="#ffaa44" text-anchor="middle">DOM Update</text>
  <text x="500" y="272" font-family="monospace" font-size="9" fill="#aaa" text-anchor="middle">No page reload!</text>

  <!-- Arrow from XHR to DOM -->
  <line x1="500" y1="200" x2="500" y2="240" stroke="#ffaa44" stroke-width="2" marker-end="url(#arrowBlue)"/>

  <!-- Code snippet -->
  <rect x="430" y="296" width="310" height="64" rx="4" fill="#111"/>
  <text x="442" y="314" font-family="monospace" font-size="11" fill="#569cd6">var</text>
  <text x="468" y="314" font-family="monospace" font-size="11" fill="#d4d4d4"> xhr = </text>
  <text x="510" y="314" font-family="monospace" font-size="11" fill="#569cd6">new</text>
  <text x="534" y="314" font-family="monospace" font-size="11" fill="#d4d4d4"> ActiveXObject(</text>
  <text x="442" y="330" font-family="monospace" font-size="11" fill="#ce9178">  "MSXML2.XMLHTTP"</text>
  <text x="442" y="346" font-family="monospace" font-size="11" fill="#d4d4d4">);</text>
  <text x="442" y="346" font-family="monospace" font-size="11" fill="#9cdcfe" x="470">xhr</text>
  <text x="442" y="348" font-family="monospace" font-size="9" fill="#6a9955">// Outlook Web Access, IE5 · 1999</text>

  <!-- Year + label -->
  <rect x="440" y="370" width="110" height="36" rx="18" fill="#0055b3"/>
  <text x="495" y="394" font-family="sans-serif" font-size="20" font-weight="bold" fill="white" text-anchor="middle">1999</text>
  <text x="590" y="388" font-family="sans-serif" font-size="13" fill="#88bbff">XMLHttpRequest</text>
  <text x="590" y="406" font-family="sans-serif" font-size="11" fill="#aaa">Async web begins</text>

  <!-- Bottom caption -->
  <text x="400" y="420" font-family="sans-serif" font-size="15" fill="#88bbff" text-anchor="middle" font-weight="bold">No Reload! — XMLHttpRequest Opens Async Web</text>
  <text x="400" y="440" font-family="sans-serif" font-size="11" fill="#888" text-anchor="middle">Microsoft IE5 · Outlook Web Access · 1999</text>
</svg>
