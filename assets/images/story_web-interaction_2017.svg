<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450" width="800" height="450">
  <defs>
    <linearGradient id="bg17" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a0d1a"/>
      <stop offset="100%" style="stop-color:#0d1a2a"/>
    </linearGradient>
  </defs>
  <rect width="800" height="450" fill="url(#bg17)"/>

  <!-- Cloudflare/Leak metaphor: water dripping from a cloud/network -->
  <!-- Cloud shape -->
  <ellipse cx="400" cy="80" rx="120" ry="45" fill="#2a2a4a" stroke="#f38020" stroke-width="2"/>
  <ellipse cx="320" cy="100" rx="60" ry="35" fill="#2a2a4a" stroke="#f38020" stroke-width="2"/>
  <ellipse cx="480" cy="100" rx="60" ry="35" fill="#2a2a4a" stroke="#f38020" stroke-width="2"/>
  <text x="400" y="90" font-family="sans-serif" font-size="14" fill="#f38020" text-anchor="middle" font-weight="bold">Cloudflare CDN</text>
  <text x="400" y="108" font-family="sans-serif" font-size="10" fill="#888" text-anchor="middle">HTML Rewriter · Reverse Proxy</text>

  <!-- Dripping data (the bug visualization) -->
  <line x1="380" y1="130" x2="380" y2="200" stroke="#ff4444" stroke-width="2" stroke-dasharray="4,4"/>
  <circle cx="380" cy="205" r="6" fill="#ff4444"/>
  <line x1="400" y1="135" x2="400" y2="215" stroke="#ff4444" stroke-width="2" stroke-dasharray="4,4"/>
  <circle cx="400" cy="220" r="8" fill="#ff4444"/>
  <line x1="420" y1="130" x2="420" y2="200" stroke="#ff4444" stroke-width="2" stroke-dasharray="4,4"/>
  <circle cx="420" cy="205" r="6" fill="#ff4444"/>

  <text x="490" y="180" font-family="monospace" font-size="11" fill="#ff6644">session_token=xK9...</text>
  <text x="490" y="198" font-family="monospace" font-size="11" fill="#ff6644">cookie: user_id=1234</text>
  <text x="490" y="216" font-family="monospace" font-size="11" fill="#ff6644">auth_key=Bearer...</text>

  <!-- Left: The bug explanation -->
  <rect x="30" y="30" width="250" height="200" rx="6" fill="#1a0a0a" stroke="#ff4444" stroke-width="1"/>
  <text x="155" y="55" font-family="sans-serif" font-size="13" fill="#ff6644" text-anchor="middle" font-weight="bold">Cloudbleed Bug</text>
  <text x="155" y="75" font-family="sans-serif" font-size="11" fill="#aaa" text-anchor="middle">HTML Parser Bug</text>
  <text x="46" y="100" font-family="sans-serif" font-size="10" fill="#888">HTML rewriter reads past</text>
  <text x="46" y="116" font-family="sans-serif" font-size="10" fill="#888">buffer boundary →</text>
  <text x="46" y="132" font-family="sans-serif" font-size="10" fill="#ff4444">private memory leaked</text>
  <text x="46" y="152" font-family="sans-serif" font-size="10" fill="#888">Other users' data mixed</text>
  <text x="46" y="168" font-family="sans-serif" font-size="10" fill="#888">into cached responses</text>
  <text x="46" y="188" font-family="sans-serif" font-size="10" fill="#888">2015-02-13 to 2018-02-18</text>
  <text x="46" y="204" font-family="sans-serif" font-size="10" fill="#ff4444">~120M+ HTTP requests</text>

  <!-- Tavis Ormandy discovery -->
  <rect x="30" y="250" width="250" height="120" rx="6" fill="#0a1628" stroke="#4488ff" stroke-width="1"/>
  <text x="155" y="272" font-family="sans-serif" font-size="12" fill="#88bbff" text-anchor="middle" font-weight="bold">Discovery</text>
  <text x="46" y="292" font-family="sans-serif" font-size="10" fill="#ccc">Feb 17, 2017 — midnight</text>
  <text x="46" y="308" font-family="sans-serif" font-size="10" fill="#ccc">Tavis Ormandy (Google</text>
  <text x="46" y="322" font-family="sans-serif" font-size="10" fill="#ccc">Project Zero) calls CF:</text>
  <text x="46" y="340" font-family="sans-serif" font-size="10" fill="#88bbff">"Random sites show other</text>
  <text x="46" y="356" font-family="sans-serif" font-size="10" fill="#88bbff">users' cookies!"</text>

  <!-- Response timeline -->
  <rect x="540" y="30" width="230" height="200" rx="6" fill="#0a1a0a" stroke="#44cc44" stroke-width="1"/>
  <text x="655" y="55" font-family="sans-serif" font-size="13" fill="#44cc44" text-anchor="middle" font-weight="bold">Response</text>
  <text x="555" y="76" font-family="sans-serif" font-size="10" fill="#888">02/17 — Bug reported</text>
  <text x="555" y="94" font-family="sans-serif" font-size="10" fill="#888">02/17 — HTML rewriter</text>
  <text x="555" y="108" font-family="sans-serif" font-size="10" fill="#888">  module disabled</text>
  <text x="555" y="126" font-family="sans-serif" font-size="10" fill="#888">02/17 — Global cache</text>
  <text x="555" y="140" font-family="sans-serif" font-size="10" fill="#888">  purged worldwide</text>
  <text x="555" y="158" font-family="sans-serif" font-size="10" fill="#888">02/23 — Public</text>
  <text x="555" y="172" font-family="sans-serif" font-size="10" fill="#888">  disclosure + blog post</text>
  <text x="555" y="190" font-family="sans-serif" font-size="10" fill="#44cc44">~47 mins to fix (hotfix)</text>
  <text x="555" y="208" font-family="sans-serif" font-size="10" fill="#888">→ session invalidation</text>

  <!-- Code showing bug (C buffer overflow) -->
  <rect x="290" y="240" width="480" height="110" rx="6" fill="#1e1e1e" stroke="#333" stroke-width="1"/>
  <text x="306" y="260" font-family="monospace" font-size="11" fill="#6a9955">/* Simplified: HTML parser bug */</text>
  <text x="306" y="278" font-family="monospace" font-size="11" fill="#569cd6">while</text>
  <text x="342" y="278" font-family="monospace" font-size="11" fill="#d4d4d4"> (ptr &lt; </text>
  <text x="392" y="278" font-family="monospace" font-size="11" fill="#9cdcfe">end</text>
  <text x="416" y="278" font-family="monospace" font-size="11" fill="#d4d4d4">) {  </text>
  <text x="464" y="278" font-family="monospace" font-size="11" fill="#6a9955">// missing bounds check!</text>
  <text x="306" y="296" font-family="monospace" font-size="11" fill="#d4d4d4">  output(</text>
  <text x="360" y="296" font-family="monospace" font-size="11" fill="#9cdcfe">*ptr++</text>
  <text x="408" y="296" font-family="monospace" font-size="11" fill="#d4d4d4">);  </text>
  <text x="448" y="296" font-family="monospace" font-size="11" fill="#ff4444">// leaks adjacent memory!</text>
  <text x="306" y="314" font-family="monospace" font-size="11" fill="#d4d4d4">}</text>
  <text x="306" y="334" font-family="monospace" font-size="11" fill="#6a9955">// Output contained private data from other requests</text>

  <!-- Impact: Security lessons -->
  <rect x="540" y="250" width="230" height="120" rx="6" fill="#1a0a1a" stroke="#aa44aa" stroke-width="1"/>
  <text x="655" y="272" font-family="sans-serif" font-size="12" fill="#cc88cc" text-anchor="middle" font-weight="bold">Security Lessons</text>
  <text x="555" y="292" font-family="sans-serif" font-size="10" fill="#888">• CDN can leak data too</text>
  <text x="555" y="308" font-family="sans-serif" font-size="10" fill="#888">• Reverse proxies need</text>
  <text x="555" y="322" font-family="sans-serif" font-size="10" fill="#888">  security audits</text>
  <text x="555" y="338" font-family="sans-serif" font-size="10" fill="#888">• Auto session invalidation</text>
  <text x="555" y="354" font-family="sans-serif" font-size="10" fill="#888">• Responsible disclosure</text>

  <!-- Year badge -->
  <rect x="310" y="370" width="180" height="36" rx="18" fill="#f38020"/>
  <text x="400" y="394" font-family="sans-serif" font-size="20" font-weight="bold" fill="white" text-anchor="middle">Cloudbleed 2017</text>

  <!-- Bottom caption -->
  <text x="400" y="424" font-family="sans-serif" font-size="11" fill="#888" text-anchor="middle">Cloudflare HTML parser memory leak · Tavis Ormandy · Feb 2017</text>
</svg>
